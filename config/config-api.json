{
    "openapi": "3.0.0",
    "info": {
        "version": "0.1",
        "title": "SOMHunter Core HTTP API",
        "license": {
            "name": "GPLv2"
        }
    },
    "servers": [
        {
            "url": "http://localhost:8888"
        }
    ],
    "paths": {
        "/api/config": {
            "get": {
                "tags": [
                    "API"
                ],
                "summary": "Gets the config JSON of the HTTP API.",
                "operationId": "NetworkApi::handle__api__config__GET",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "examples": {
                                    "test1": {}
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/settings": {
            "get": {
                "tags": [
                    "Client"
                ],
                "summary": "Gets the config JSON from the core.",
                "operationId": "get_settings",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__Settings__Get"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/user/context": {
            "get": {
                "tags": [
                    "Client"
                ],
                "summary": "Gets the current state of the user.",
                "operationId": "user_context_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "user_ID",
                        "schema": {
                            "type": "integer"
                        },
                        "description": "(YTBI) ID of the user who is asking."
                    },
                    {
                        "in": "query",
                        "name": "auth_token",
                        "schema": {
                            "type": "string"
                        },
                        "description": "(YTBI) The last access token recieved from the core."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__User__Context__Get"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/search/get-top-display": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Gets the top scored display data.",
                "operationId": "search_get_top_display",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Request__GetTopScreen__Post"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__GetTopScreen__Post"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/search/get-som-display": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Gets the SOM display data.",
                "operationId": "search_get_som_screen_post",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__GetTopScreen__Post"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/search/get-som-relocation-display": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Gets the SOM relocation display data.",
                "operationId": "search_get_som_relocation_display",
                "parameters": [
                    {
                        "in": "query",
                        "name": "temporalId",
                        "schema": {
                            "type": "integer"
                        },
                        "description": "Index of temporal query."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__GetTopScreen__Post"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/dataset/video-detail": {
            "get": {
                "tags": [
                    "Dataset"
                ],
                "summary": "Gets the data about the frame.",
                "operationId": "search_video_detail_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "pageId",
                        "schema": {
                            "type": "integer"
                        },
                        "description": "Page index."
                    },
                    {
                        "in": "query",
                        "name": "type",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Type of display to serve.."
                    },
                    {
                        "in": "query",
                        "name": "frameId",
                        "schema": {
                            "type": "integer"
                        },
                        "description": "ID of frame we're interested in."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__FrameDetailData__Get"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/search/keyword-autocomplete": {
            "get": {
                "tags": [
                    "Search session"
                ],
                "summary": "Returns the nearest supported keywords.",
                "operationId": "search_keyword_autocomplete",
                "parameters": [
                    {
                        "in": "query",
                        "name": "queryValue",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Prefix of a string we're interested in."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__GetAutocompleteResults__Get"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/log/scroll": {
            "get": {
                "tags": [
                    "Logs"
                ],
                "summary": "Notifies the core about thhis event.",
                "operationId": "log_scroll_event",
                "parameters": [
                    {
                        "in": "query",
                        "name": "query",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Current text query."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/log/text-query-change": {
            "get": {
                "tags": [
                    "Logs"
                ],
                "summary": "Notifies the core about thhis event.",
                "operationId": "log_text_query_change",
                "parameters": [
                    {
                        "in": "query",
                        "name": "query",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Current text of the query."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        },
        "/eval-server/submit": {
            "post": {
                "tags": [
                    "Evaluation server"
                ],
                "summary": "Submits the specified frame ID to the evaluation server.",
                "operationId": "NetworkApi::handle__submit_frame__POST",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {}
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/eval-server/login": {
            "post": {
                "tags": [
                    "Evaluation server"
                ],
                "summary": "TODO",
                "operationId": "NetworkApi::handle__login_to_dres__POST",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "result": {
                                        "type": "boolean"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/eval-server/logout": {
            "post": {
                "tags": [
                    "Evaluation server"
                ],
                "summary": "TODO",
                "operationId": "logout_from_eval_server",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "result": {
                                        "type": "boolean"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/search/reset": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Resets the user's search session.",
                "operationId": "search_reset",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {}
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/search/rescore": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Applies the current query on the scores.",
                "operationId": "search_rescore",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Request__Rescore__Post"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/search/like-frame": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "(De)selects the provided frames as a positive example for relevance feedback models.",
                "operationId": "search_like_frame",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {}
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/search/bookmark-frame": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Bookmarks the selected frame for later use.",
                "operationId": "search_bookmark_frame",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {}
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            }
        },
        "/search/context": {
            "post": {
                "tags": [
                    "Search session"
                ],
                "summary": "Switches context to the provided one.",
                "operationId": "search_context_post",
                "requestBody": {
                    "description": "...",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "srcSearchCtxId": {
                                        "type": "integer"
                                    },
                                    "screenshotData": {
                                        "type": "string"
                                    },
                                    "id": {
                                        "type": "integer"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Response__User__Context__Get"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error"
                    }
                }
            },
            "get": {
                "tags": [
                    "Search session"
                ],
                "summary": "Returns the current user's search context.",
                "operationId": "search_context_get",
                "parameters": [
                    {
                        "in": "query",
                        "name": "queryValue",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Prefix of a string we're interested in."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {}
                        }
                    },
                    "500": {
                        "description": "Error",
                        "content": {
                            "application/json": {}
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "Request__Rescore__Post": {
                "type": "object",
                "properties": {
                    "canvas_query": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/CanvasQuery"
                        }
                    }
                }
            },
            "CanvasQuery": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/CanvasSubquery"
                }
            },
            "CanvasSubquery": {
                "type": "array",
                "items": {
                    "oneOf": [
                        {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "enum": [
                                        "bitmap"
                                    ]
                                },
                                "rect": {
                                    "type": "array",
                                    "items": {
                                        "type": "number",
                                        "minimum": 0.0,
                                        "maximum": 1.0,
                                        "minItems": 4,
                                        "maxItems": 4,
                                        "exclusiveMinimum": true,
                                        "exclusiveMaximum": true
                                    }
                                },
                                "num_channels": {
                                    "type": "integer"
                                },
                                "width_pixels": {
                                    "type": "integer"
                                },
                                "height_pixels": {
                                    "type": "integer"
                                },
                                "bitmap_data": {
                                    "type": "array",
                                    "items": {
                                        "type": "integer"
                                    }
                                }
                            }
                        },
                        {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "enum": [
                                        "text"
                                    ]
                                },
                                "rect": {
                                    "type": "array",
                                    "items": {
                                        "type": "number",
                                        "minimum": 0.0,
                                        "maximum": 1.0,
                                        "minItems": 4,
                                        "maxItems": 4,
                                        "exclusiveMinimum": true,
                                        "exclusiveMaximum": true
                                    }
                                },
                                "text_query": {
                                    "type": "string"
                                }
                            }
                        }
                    ]
                }
            },
            "Response__FrameDetailData__Get": {
                "required": [
                    "frames",
                    "page"
                ],
                "type": "object",
                "properties": {
                    "page": {
                        "type": "integer"
                    },
                    "frames": {
                        "$ref": "#/components/schemas/ArrayOfFrameReferences"
                    }
                }
            },
            "Request__GetTopScreen__Post": {
                "required": [
                    "frameId",
                    "pageId",
                    "type"
                ],
                "type": "object",
                "properties": {
                    "frameId": {
                        "type": "integer"
                    },
                    "pageId": {
                        "type": "integer"
                    },
                    "type": {
                        "type": "string"
                    }
                }
            },
            "Response__GetTopScreen__Post": {
                "type": "object",
                "properties": {
                    "viewData": {
                        "$ref": "#/components/schemas/ViewData"
                    }
                }
            },
            "Response__GetAutocompleteResults__Get": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/KeywordReference"
                }
            },
            "DisplayData": {
                "type": "object",
                "properties": {
                    "type": {
                        "$ref": "#/components/schemas/DisplayType"
                    },
                    "page": {
                        "type": "integer"
                    },
                    "frames": {
                        "$ref": "#/components/schemas/ArrayOfFrameReferences"
                    }
                }
            },
            "ArrayOfFrameReferences": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/FrameReference"
                }
            },
            "Response__Settings__Get": {
                "required": [
                    "api",
                    "core"
                ],
                "type": "object",
                "properties": {
                    "api": {
                        "type": "object"
                    },
                    "core": {
                        "type": "object"
                    }
                }
            },
            "Response__User__Context__Get": {
                "required": [
                    "search",
                    "history",
                    "bookmarkedFrames"
                ],
                "type": "object",
                "properties": {
                    "search": {
                        "$ref": "#/components/schemas/SearchContext"
                    },
                    "history": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/HistoryState"
                        }
                    },
                    "bookmarkedFrames": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/FrameReference"
                        }
                    }
                }
            },
            "SearchContext": {
                "type": "object",
                "properties": {
                    "textQueries": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "displayType": {
                        "type": "string"
                    },
                    "screenshotFilepath": {
                        "type": "string"
                    },
                    "id": {
                        "type": "integer"
                    },
                    "likedFrames": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/FrameReference"
                        }
                    },
                    "filters": {
                        "$ref": "#/components/schemas/QueryFilters"
                    },
                    "relocation": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/FrameReference"
                        }
                    }
                }
            },
            "FrameReference": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "vId": {
                        "type": "integer"
                    },
                    "sId": {
                        "type": "integer"
                    },
                    "hour": {
                        "type": "integer",
                        "nullable": true
                    },
                    "weekday": {
                        "type": "integer",
                        "nullable": true
                    },
                    "lscId": {
                        "type": "string",
                        "nullable": true
                    },
                    "liked": {
                        "type": "boolean"
                    },
                    "bookmarked": {
                        "type": "boolean"
                    },
                    "src": {
                        "type": "string"
                    }
                }
            },
            "KeywordReference": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "wordString": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "exampleFrames": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                }
            },
            "HistoryState": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "screenshotFilepath": {
                        "type": "string"
                    },
                    "time": {
                        "type": "string"
                    }
                }
            },
            "QueryFilters": {
                "type": "object",
                "properties": {
                    "weekdays": {
                        "type": "array",
                        "items": {
                            "type": "boolean"
                        }
                    },
                    "hourFrom": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "hourTo": {
                        "type": "integer"
                    }
                }
            },
            "DisplayType": {
                "type": "string"
            },
            "TextQueriesState": {
                "type": "object",
                "properties": {
                    "q0": {
                        "type": "object",
                        "properties": {
                            "value": {
                                "type": "string"
                            }
                        }
                    },
                    "q1": {
                        "type": "object",
                        "properties": {
                            "value": {
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "SomhunterViewData": {
                "type": "object",
                "properties": {
                    "textQueries": {
                        "$ref": "#/components/schemas/TextQueriesState"
                    },
                    "frameContext": {
                        "type": "object"
                    },
                    "screen": {
                        "$ref": "#/components/schemas/DisplayData"
                    }
                }
            },
            "ViewData": {
                "type": "object",
                "properties": {
                    "somhunter": {
                        "$ref": "#/components/schemas/SomhunterViewData"
                    }
                }
            }
        }
    }
}